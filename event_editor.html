<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Chrono Tape - Event Editor</title>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; padding: 20px; display: flex; gap: 20px; }
        .panel { background: #222; padding: 20px; border-radius: 8px; border: 1px solid #444; width: 45%; }
        h2 { color: #ffcc00; margin-top: 0; }
        label { display: block; margin-top: 10px; color: #aaa; font-size: 12px; }
        input, textarea, select { width: 100%; background: #333; border: 1px solid #555; color: #fff; padding: 8px; margin-top: 5px; box-sizing: border-box; }
        button { background: #2980b9; color: white; border: none; padding: 10px 20px; cursor: pointer; margin-top: 20px; font-weight: bold; }
        button:hover { background: #3498db; }
        .choice-box { background: #333; padding: 10px; margin-top: 10px; border-left: 3px solid #ffcc00; }
        pre { background: #000; padding: 10px; border: 1px solid #444; color: #0f0; white-space: pre-wrap; word-break: break-all; }
    </style>
</head>
<body>

    <div class="panel">
        <h2>ğŸ“ ìƒˆ ì´ë²¤íŠ¸ ì‘ì„±</h2>
        
        <label>ì´ë²¤íŠ¸ ID (ì˜ë¬¸)</label>
        <input type="text" id="evt-id" placeholder="ì˜ˆ: ancient_shrine">
        
        <label>ì œëª©</label>
        <input type="text" id="evt-title" placeholder="ì˜ˆ: ê³ ëŒ€ì˜ ì œë‹¨">
        
        <label>ë‚´ìš© (ì¤„ë°”ê¿ˆ ê°€ëŠ¥)</label>
        <textarea id="evt-desc" rows="4" placeholder="ì´ë²¤íŠ¸ ìƒí™©ì„ ë¬˜ì‚¬í•˜ì„¸ìš”..."></textarea>
        
        <label>ë“±ì¥ ì¡°ê±´ (JS ì½”ë“œ, ë¹„ì›Œë‘ë©´ ë¬´ì¡°ê±´ ë“±ì¥)</label>
        <input type="text" id="evt-req" placeholder="ì˜ˆ: data.currentHp < 50">
        
        <h3 style="margin-top: 20px; border-bottom: 1px solid #555; padding-bottom: 5px;">ì„ íƒì§€ ê´€ë¦¬</h3>
        <div id="choices-container"></div>
        <button onclick="addChoice()" style="background: #444; width: 100%; margin-top:10px;">+ ì„ íƒì§€ ì¶”ê°€</button>

        <button onclick="generateCode()" style="width: 100%; font-size: 18px; margin-top: 30px;">ğŸ’¾ ì½”ë“œ ìƒì„±</button>
    </div>

    <div class="panel">
        <h2>ğŸ“¤ ìƒì„±ëœ ì½”ë“œ</h2>
        <p style="color:#888; font-size:12px;">ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ <b>js/data/EventData.js</b> íŒŒì¼ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
        <pre id="output-code">// ì—¬ê¸°ì— ì½”ë“œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</pre>
        <button onclick="copyCode()" style="background: #27ae60;">ğŸ“‹ í´ë¦½ë³´ë“œ ë³µì‚¬</button>
    </div>

    <script>
        function addChoice() {
            const container = document.getElementById('choices-container');
            const idx = container.children.length + 1;
            const div = document.createElement('div');
            div.className = 'choice-box';
            div.innerHTML = `
                <div style="font-weight:bold; color:#ffcc00; margin-bottom:5px;">ì„ íƒì§€ #${idx}</div>
                <label>ë²„íŠ¼ í…ìŠ¤íŠ¸</label>
                <input type="text" class="c-text" placeholder="ì˜ˆ: [ê¸°ë„] ì²´ë ¥ íšŒë³µ">
                <label>ì„ íƒ ì¡°ê±´ (JS ì½”ë“œ, ë¹„ì›Œë‘ë©´ í•­ìƒ ê°€ëŠ¥)</label>
                <input type="text" class="c-req" placeholder="ì˜ˆ: data.gold >= 50">
                <label>íš¨ê³¼ ìŠ¤í¬ë¦½íŠ¸ (ê²°ê³¼ ë©”ì‹œì§€ ë¦¬í„´ í•„ìˆ˜)</label>
                <textarea class="c-effect" rows="2" placeholder="ì˜ˆ: data.currentHp += 20; return 'ì²´ë ¥ì´ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤.';"></textarea>
                <button onclick="this.parentElement.remove()" style="background:#c0392b; padding:5px 10px; font-size:12px; margin-top:5px;">ì‚­ì œ</button>
            `;
            container.appendChild(div);
        }

        function generateCode() {
            const id = document.getElementById('evt-id').value || 'evt_' + Date.now();
            const title = document.getElementById('evt-title').value;
            const desc = document.getElementById('evt-desc').value;
            const req = document.getElementById('evt-req').value;

            const choicesDivs = document.querySelectorAll('.choice-box');
            let choicesCode = '';

            choicesDivs.forEach(div => {
                const text = div.querySelector('.c-text').value;
                const cReq = div.querySelector('.c-req').value;
                const effect = div.querySelector('.c-effect').value;

                choicesCode += `
            {
                text: "${text}",
                req: ${cReq ? `(data) => ${cReq}` : 'null'},
                effect: (scene, data) => {
                    ${effect}
                }
            },`;
            });

            const finalCode = `
    {
        id: "${id}",
        title: "${title}",
        desc: \`${desc}\`,
        req: ${req ? `(data) => ${req}` : 'null'},
        choices: [${choicesCode}
        ]
    },`;

            document.getElementById('output-code').innerText = finalCode;
        }

        function copyCode() {
            const code = document.getElementById('output-code').innerText;
            navigator.clipboard.writeText(code).then(() => alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"));
        }

        // ì´ˆê¸° ì„ íƒì§€ 1ê°œ ì¶”ê°€
        addChoice();
    </script>
</body>
</html>